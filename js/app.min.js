var API="c4672ea6b91af024edb4419cd157396a";API="9a7e1254b9aa6badfe70164e6cfe815d";var next=10,leagusName={39:"Premier League",61:"League 1",78:"Bundesliga",135:"Serie A",88:"Eredivisie",140:"La Liga"},leagusIds=Object.keys(leagusName),fixtureCount=next*leagusIds.length;window.statistics={},window.allTeams={},window.globalJson={fixtures:[],predictions:[],time:""},"localhost"!==location.hostname&&"192.168.0.30"!==location.hostname||$("button").show(),GetPantryJson(),getStatistics();var stats='<table class="sticky">';function GetPantryJson(){$.ajax({url:"https://getpantry.cloud/apiv1/pantry/1f3a2c9e-cbc5-4c5b-b93f-5d0f48a83ce8/basket/bet",method:"GET",timeout:0,headers:{"Content-Type":"application/json"}}).done(function(t){globalJson=t,console.log(t),WriteToBodyPantry(t)}).fail(function(){setTimeout(function(){GetPantryJson()},3e3)})}function GetFixtures(){for(let e=0;e<leagusIds.length;e++){var t=leagusIds[e];fetch("https://v3.football.api-sports.io/fixtures?league="+t+"&next="+next+"&status=NS",{method:"GET",headers:{"x-rapidapi-host":"v3.football.api-sports.io","x-rapidapi-key":API}}).then(t=>t.text()).then(t=>WriteToBody(t)).catch(t=>console.log("error",t))}}function getStatistics(){var t=!1,e={},a=0;for(let s=0;s<leagusIds.length;s++){var r={url:"https://v3.football.api-sports.io/fixtures?league="+leagusIds[s]+"&season=2022&status=FT",method:"GET",timeout:0,headers:{"x-rapidapi-key":API,"x-rapidapi-host":"v3.football.api-sports.io"}};$.ajax(r).done(function(r){++a==leagusIds.length&&(t=!0);var s=leagusName[r.parameters.league],i='<table id="league-'+s.replace(" ","_")+'">';statistics[r.parameters.league]=r.response,i+="<tr><th>"+s+"</th></tr>";var h=r.response,o=r.results,n=0,l=0,d=0,p=0,c=0,u=0,m=0,g=0,f=0,x=0,I=0,v=0,b=0,F=0,y=0,T=0,w=0,P=0,k=0,G=0,J=0,W=0,L=0,S=0;for(let t=0;t<h.length;t++){var N=h[t].score,j=N.halftime.home,B=N.halftime.away,D=N.fulltime.home,A=N.fulltime.away,O=D+A,U=j+B,X=O-U;n+=O,O>0?(p++,O>1&&c++,O>2&&u++,O>3&&m++,O>4&&g++):l++,O<5&&f++,D===A&&d++,D>A&&x++,A>D&&I++,D>0&&A>0&&v++,U>1&&b++,X>1&&F++,(D>A||D===A)&&y++,(A>D||D===A)&&w++,D!=A&&T++,U<=1&&X<=1&&P++,U<=1&&X<=2&&k++,U<=1&&X<=3&&G++,U<=2&&X<=1&&J++,U<=2&&X<=2&&W++,U<=2&&X<=3&&L++,U>=1&&X>=1&&S++}if(i+="<tr><th>"+o+"</th></tr>",i+="<tr><th>"+n+" ( "+(n/o).toFixed(1)+" )</th></tr>",i+="<tr><th>"+l+" <span>("+(l/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+d+" <span>("+(d/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+p+" <span>("+(p/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+c+" <span>("+(c/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+u+" <span>("+(u/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+m+" <span>("+(m/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+g+" <span>("+(g/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+f+" <span>("+(f/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+x+" <span>("+(x/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+I+" <span>("+(I/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+v+" <span>("+(v/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+b+" <span>("+(b/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+F+" <span>("+(F/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+y+" <span>("+(y/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+T+" <span>("+(T/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+w+" <span>("+(w/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+P+" <span>("+(P/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+k+" <span>("+(k/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+G+" <span>("+(G/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+J+" <span>("+(J/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+W+" <span>("+(W/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+L+" <span>("+(L/o*100).toFixed(2)+"%)</span></th></tr>",i+="<tr><th>"+S+" <span>("+(S/o*100).toFixed(2)+"%)</span></th></tr>",i+="</table>",e[r.parameters.league]=i,t){"<tr><th>Liga</th></tr>","<tr><th>Broj utakmica</th></tr>","<tr><th>Broj golova</th></tr>","<tr><th>0-0</th></tr>","<tr><th>X</th></tr>","<tr><th>1+</th></tr>","<tr><th>2+</th></tr>","<tr><th>3+</th></tr>","<tr><th>4+</th></tr>","<tr><th>5+</th></tr>","<tr><th>0-4</th></tr>","<tr><th>Dom. pobednik</th></tr>","<tr><th>Gost pobednik</th></tr>","<tr><th>GG</th></tr>","<tr><th>I Pol. 2+</th></tr>","<tr><th>II Pol. 2+</th></tr>","<tr><th>1X</th></tr>","<tr><th>12</th></tr>","<tr><th>X2</th></tr>","<tr><th>I0-1&II0-1</th></tr>","<tr><th>I0-1&II0-2</th></tr>","<tr><th>I0-1&II0-3</th></tr>","<tr><th>I0-2&II0-1</th></tr>","<tr><th>I0-2&II0-2</th></tr>","<tr><th>I0-2&II0-3</th></tr>","<tr><th>I1+&II1+</th></tr>","</table>",'<div class="values-wrapper">','<div class="values"></div>',"</div>",$('<table class="sticky"><tr><th>Liga</th></tr><tr><th>Broj utakmica</th></tr><tr><th>Broj golova</th></tr><tr><th>0-0</th></tr><tr><th>X</th></tr><tr><th>1+</th></tr><tr><th>2+</th></tr><tr><th>3+</th></tr><tr><th>4+</th></tr><tr><th>5+</th></tr><tr><th>0-4</th></tr><tr><th>Dom. pobednik</th></tr><tr><th>Gost pobednik</th></tr><tr><th>GG</th></tr><tr><th>I Pol. 2+</th></tr><tr><th>II Pol. 2+</th></tr><tr><th>1X</th></tr><tr><th>12</th></tr><tr><th>X2</th></tr><tr><th>I0-1&II0-1</th></tr><tr><th>I0-1&II0-2</th></tr><tr><th>I0-1&II0-3</th></tr><tr><th>I0-2&II0-1</th></tr><tr><th>I0-2&II0-2</th></tr><tr><th>I0-2&II0-3</th></tr><tr><th>I1+&II1+</th></tr></table><div class="values-wrapper"><div class="values"></div></div>').appendTo("#statistics");for(let t=0;t<leagusIds.length;t++)e[leagusIds[t]]&&$(e[leagusIds[t]]).appendTo("#statistics .values");setTimeout(function(){var t=$("#statisticsTeam select"),e="";if(Object.keys(statistics).length>0)for(var a in statistics)if(statistics.hasOwnProperty(a)){allTeams[a]={},e+='<optgroup label="'+leagusName[a]+'">';var r=statistics[a];for(let t=0;t<r.length;t++){var s=r[t],i=s.teams.home,h=s.teams.away,o=i.id,n=h.id;allTeams[a][o]||(allTeams[a][o]=i.name,e+='<option data-leagueID="'+a+'" data-id="'+o+'">'+i.name+"</option>"),allTeams[a][n]||(allTeams[a][n]=h.name,e+='<option data-leagueID="'+a+'" data-id="'+n+'">'+h.name+"</option>")}e+="</optgroup>"}t.html(e),UpdateValuesWidth(),$(".chosen-select").multipleSelect({hideOptgroupCheckboxes:!0,selectAll:!1,width:"100%",onClick:function(t){if(t.selected){var e=t.data.leagueid,a=t.data.id,r=t.text,s=statistics[e].filter(t=>t.teams.away.id==a||t.teams.home.id==a),i=s.length,h=0,o=0,n=0,l=0,d=0,p=0,c=0,u=0,m=0,g=0,f=0,x=0,I=0,v=0,b=0,F=0,y=0,T=0,w=0,P=0,k=0,G=0,J=0,W=0,L=0,S=0,N=0,j=0,B=0,D=0,A=0,O=0;if($("#tim-"+r.replace(" ","_")).length)return!1;for(let t=0;t<s.length;t++){var U=s[t],X=U.score,_=X.halftime.home,E=X.halftime.away,V=X.fulltime.home,C=X.fulltime.away,M=V+C,H=_+E,Y=M-H,R=U.teams.home.id==a;R?(h+=V,l++,V>0&&p++,V>1&&c++,V>2&&u++):(h+=C,d++,C>0&&m++,C>1&&g++,C>2&&f++),M>0?(x++,M>1&&I++,M>2&&v++,M>3&&b++,M>4&&F++):o++,M<5&&y++,V===C&&n++,R&&V>C&&T++,!R&&C>V&&w++,H>1&&k++,Y>1&&G++,V>0&&C>0&&P++,R?(V>C||V===C)&&J++:(C>V||V===C)&&L++,V!=C&&W++,H<=1&&Y<=1&&S++,H<=1&&Y<=2&&N++,H<=1&&Y<=3&&j++,H<=2&&Y<=1&&B++,H<=2&&Y<=2&&D++,H<=2&&Y<=3&&A++,H>=1&&Y>=1&&O++}var z='<table data-id="'+a+'" data-teamName="'+r+'" id="tim-'+r.replace(" ","_")+'">';z+="<tr><th>"+r+"</th></tr>",z+="<tr><th>"+i+"</th></tr>",z+="<tr><th>"+h+" ( "+(h/i).toFixed(1)+" )</th></tr>",z+="<tr><th>"+o+" <span>("+(o/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+n+" <span>("+(n/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+x+" <span>("+(x/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+I+" <span>("+(I/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+v+" <span>("+(v/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+b+" <span>("+(b/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+F+" <span>("+(F/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+y+" <span>("+(y/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+p+" <span>("+(p/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+c+" <span>("+(c/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+u+" <span>("+(u/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+m+" <span>("+(m/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+g+" <span>("+(g/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+f+" <span>("+(f/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+T+" <span>("+(T/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+w+" <span>("+(w/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+P+" <span>("+(P/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+k+" <span>("+(k/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+G+" <span>("+(G/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+J+" <span>("+(J/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+W+" <span>("+(W/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+L+" <span>("+(L/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+S+" <span>("+(S/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+N+" <span>("+(N/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+j+" <span>("+(j/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+B+" <span>("+(B/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+D+" <span>("+(D/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+A+" <span>("+(A/i*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+O+" <span>("+(O/i*100).toFixed(2)+"%)</span></th></tr>",z+='<tr class="remove_table"><th>X</th></tr>',z+="</table>",$(z).appendTo("#statisticsTeam .values")}else $("#tim-"+t.text.replace(" ","_")).length&&$("#tim-"+t.text.replace(" ","_")).remove();UpdateValuesWidth()}})},100)}})}}function UpdateValuesWrapperWidth(){$(".values-wrapper").each(function(){var t=$(this).parent();$(this).width(t.width()-t.find(".sticky").width()-5)})}function UpdateValuesWidth(){UpdateValuesWrapperWidth(),$(".values-wrapper").each(function(){var t=$(this).find("table"),e=$(this).find(".values"),a=0;t.each(function(){a+=$(this).outerWidth(!0)}),a>$(this).width()?e.width(a):e.css("width","")})}stats+="<tr><th>Tim</th></tr>",stats+="<tr><th>Broj utakmica</th></tr>",stats+="<tr><th>Broj golova</th></tr>",stats+="<tr><th>0-0</th></tr>",stats+="<tr><th>X</th></tr>",stats+="<tr><th>1+</th></tr>",stats+="<tr><th>2+</th></tr>",stats+="<tr><th>3+</th></tr>",stats+="<tr><th>4+</th></tr>",stats+="<tr><th>5+</th></tr>",stats+="<tr><th>0-4</th></tr>",stats+="<tr><th>Tim domacin 1+</th></tr>",stats+="<tr><th>Tim domacin 2+</th></tr>",stats+="<tr><th>Tim domacin 3+</th></tr>",stats+="<tr><th>Tim gost 1+</th></tr>",stats+="<tr><th>Tim gost 2+</th></tr>",stats+="<tr><th>Tim gost 3+</th></tr>",stats+="<tr><th>Dom. pobednik</th></tr>",stats+="<tr><th>Gost pobednik</th></tr>",stats+="<tr><th>GG</th></tr>",stats+="<tr><th>I Pol. 2+</th></tr>",stats+="<tr><th>II Pol. 2+</th></tr>",stats+="<tr><th>1X</th></tr>",stats+="<tr><th>12</th></tr>",stats+="<tr><th>X2</th></tr>",stats+="<tr><th>I0-1&II0-1</th></tr>",stats+="<tr><th>I0-1&II0-2</th></tr>",stats+="<tr><th>I0-1&II0-3</th></tr>",stats+="<tr><th>I0-2&II0-1</th></tr>",stats+="<tr><th>I0-2&II0-2</th></tr>",stats+="<tr><th>I0-2&II0-3</th></tr>",stats+="<tr><th>I1+&II1+</th></tr>",stats+='<tr class="remove_table" style="display: none;"><th>X</th></tr>',stats+="</table>",stats+='<div class="values-wrapper">',stats+='<div class="values"></div>',stats+="</div>",$(stats).appendTo("#statisticsTeam"),UpdateValuesWrapperWidth(),$("body").on("click","#pantryLoad",function(){GetPantryJson()}).on("click","#apiLoad",function(){var t=new Date,e=String(t.getDate()).padStart(2,"0");globalJson={fixtures:[],predictions:[],time:e},GetFixtures()}).on("click","#getStatistics",function(){getStatistics()}).on("click",".remove_table",function(t){$(this).closest("table").remove(),UpdateValuesWidth();var e=$(this).closest("[data-teamName]").attr("data-teamName");$(".chosen-select").multipleSelect("uncheck",e)}).on("click","a[team-id]",function(t){t.preventDefault}),window.UpdatePantryJson=function(t){if(t){var e={url:"https://getpantry.cloud/apiv1/pantry/1f3a2c9e-cbc5-4c5b-b93f-5d0f48a83ce8/basket/bet",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify(t)};$.ajax(e).done(function(t){console.log(t),GetPantryJson()}).fail(function(){setTimeout(function(){UpdatePantryJson(globalJson)},3e3)})}},$(window).on("resize",function(){UpdateValuesWidth()});var numberOfFixturesLoaded=0;function WriteToBody(t){numberOfFixturesLoaded++;var e=(t=JSON.parse(t)).response;for(let t=0;t<e.length;t++){var a=e[t];a.fixture.id;globalJson.fixtures.push(a)}if(numberOfFixturesLoaded==leagusIds.length){var r=globalJson.fixtures.length;console.log("ALl fixtures loaded");for(let t=0;t<r;t++)setTimeout(function(){GetPrediction(globalJson.fixtures[t].fixture.id,t===r-1)},2e3*t)}}function GetPrediction(t,e){fetch("https://v3.football.api-sports.io/predictions?fixture="+t,{method:"GET",headers:{"x-rapidapi-host":"v3.football.api-sports.io","x-rapidapi-key":API}}).then(t=>t.text()).then(a=>WritePrediction(a,t,e)).catch(t=>console.log("error",t))}function WritePrediction(t,e,a){if((t=JSON.parse(t)).response.length){var r=t.response[0].predictions;r.id=e,console.log("prediction "+e+" loaded"),globalJson.predictions.push(r),WriteToBodyPantry(globalJson)}a&&(console.log("UPDATE PANTRY JSON HERE"),UpdatePantryJson(globalJson))}function WriteToBodyPantry(t){var e=t.fixtures,a=document.getElementById("wrapper"),r="";for(let a=0;a<leagusIds.length;a++){var s=leagusIds[a],i=e.filter(t=>t.league.id==s);if(0!==i.length){r+='<div class="league" league-id="'+s+'" league-name="'+leagusName[s]+'">',r+='<div class="league-logo"><img src="'+i[0].league.logo+'"/></div>';for(let e=0;e<i.length;e++){var h=i[e],o=h.fixture.id,n=h.teams.home,l=h.teams.away,d=new Date(h.fixture.date),p=t.predictions.find(t=>t.id===o);p&&(r+='<div class="row" data-round="'+h.league.round+'">',r+='<div class="time">'+d.getDate()+"."+(d.getMonth()+1)+"."+d.getFullYear()+" - "+d.getHours()+":"+(d.getMinutes()<10?"0":"")+d.getMinutes()+"h</div>",r+='<div class="team home">',r+='<img src="'+n.logo+'"/><a team-id="'+n.id+'">'+n.name+"</a>",r+="</div>",r+='<div id="'+o+'" class="prediction">',p.under_over?r+=p.under_over:p.advice?r+=p.advice.replace("Double chance","Dupla šansa").replace(" or "," ili ").replace("Winner","Pobednik").replace("draw","nerešeno").replace("and","i").replace("goals","golova").replace("Combo",""):r+="------",r+="</div>",r+='<div class="team away">',r+='<img src="'+l.logo+'"/><a team-id="'+l.id+'" >'+l.name+"</a>",r+="</div>",r+="</div>")}r+="</div>"}}a.innerHTML=r}var options={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};function success(t){var e=t.coords,a="- - - - - - - - - - - - -";a+="Your current position is:",a+="Latitude : "+e.latitude,a+="Longitude : "+e.longitude,a+="More or less "+e.accuracy+" meters",$("#location").text($("#location").text()+a)}function error(t){$("#location").text(t.message)}setInterval(function(){navigator.geolocation.getCurrentPosition(success,error,options)},5e3);