var API="c4672ea6b91af024edb4419cd157396a";API="9a7e1254b9aa6badfe70164e6cfe815d";var next=10,leagusName={39:"Premier League",61:"League 1",78:"Bundesliga",135:"Serie A",88:"Eredivisie",140:"La Liga"},leagusIds=Object.keys(leagusName),fixtureCount=next*leagusIds.length;window.statistics={},window.allTeams={},window.globalJson={fixtures:[],predictions:[],time:""},"localhost"!==location.hostname&&"192.168.0.30"!==location.hostname||$("button").show(),GetPantryJson(),getStatistics();var stats='<table class="sticky">';function GetPantryJson(){$.ajax({url:"https://getpantry.cloud/apiv1/pantry/1f3a2c9e-cbc5-4c5b-b93f-5d0f48a83ce8/basket/bet",method:"GET",timeout:0,headers:{"Content-Type":"application/json"}}).done(function(t){globalJson=t,console.log(t),WriteToBodyPantry(t)}).fail(function(){setTimeout(function(){GetPantryJson()},3e3)})}function GetFixtures(){for(let a=0;a<leagusIds.length;a++){var t=leagusIds[a];fetch("https://v3.football.api-sports.io/fixtures?league="+t+"&next="+next+"&status=NS",{method:"GET",headers:{"x-rapidapi-host":"v3.football.api-sports.io","x-rapidapi-key":API}}).then(t=>t.text()).then(t=>WriteToBody(t)).catch(t=>console.log("error",t))}}function getStatistics(){var t=!1,a={},e=0;for(let s=0;s<leagusIds.length;s++){var r={url:"https://v3.football.api-sports.io/fixtures?league="+leagusIds[s]+"&season=2022&status=FT",method:"GET",timeout:0,headers:{"x-rapidapi-key":API,"x-rapidapi-host":"v3.football.api-sports.io"}};$.ajax(r).done(function(r){++e==leagusIds.length&&(t=!0);var s=leagusName[r.parameters.league],h='<table id="league-'+s.replace(" ","_")+'">';statistics[r.parameters.league]=r.response,h+="<tr><th>"+s+"</th></tr>";var i=r.response,o=r.results,n=0,l=0,d=0,p=0,c=0,u=0,m=0,g=0,f=0,x=0,I=0,v=0,b=0,F=0,y=0,T=0,w=0,P=0,k=0,G=0,J=0,W=0,S=0,N=0;for(let t=0;t<i.length;t++){var j=i[t].score,B=j.halftime.home,D=j.halftime.away,L=j.fulltime.home,O=j.fulltime.away,U=L+O,X=B+D,A=U-X;n+=U,U>0?(p++,U>1&&c++,U>2&&u++,U>3&&m++,U>4&&g++):l++,U<5&&f++,L===O&&d++,L>O&&x++,O>L&&I++,L>0&&O>0&&v++,X>1&&b++,A>1&&F++,(L>O||L===O)&&y++,(O>L||L===O)&&w++,L!=O&&T++,X<=1&&A<=1&&P++,X<=1&&A<=2&&k++,X<=1&&A<=3&&G++,X<=2&&A<=1&&J++,X<=2&&A<=2&&W++,X<=2&&A<=3&&S++,X>=1&&A>=1&&N++}if(h+="<tr><th>"+o+"</th></tr>",h+="<tr><th>"+n+" ( "+(n/o).toFixed(1)+" )</th></tr>",h+="<tr><th>"+l+" <span>("+(l/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+d+" <span>("+(d/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+p+" <span>("+(p/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+c+" <span>("+(c/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+u+" <span>("+(u/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+m+" <span>("+(m/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+g+" <span>("+(g/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+f+" <span>("+(f/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+x+" <span>("+(x/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+I+" <span>("+(I/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+v+" <span>("+(v/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+b+" <span>("+(b/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+F+" <span>("+(F/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+y+" <span>("+(y/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+T+" <span>("+(T/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+w+" <span>("+(w/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+P+" <span>("+(P/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+k+" <span>("+(k/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+G+" <span>("+(G/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+J+" <span>("+(J/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+W+" <span>("+(W/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+S+" <span>("+(S/o*100).toFixed(2)+"%)</span></th></tr>",h+="<tr><th>"+N+" <span>("+(N/o*100).toFixed(2)+"%)</span></th></tr>",h+="</table>",a[r.parameters.league]=h,t){"<tr><th>Liga</th></tr>","<tr><th>Broj utakmica</th></tr>","<tr><th>Broj golova</th></tr>","<tr><th>0-0</th></tr>","<tr><th>X</th></tr>","<tr><th>1+</th></tr>","<tr><th>2+</th></tr>","<tr><th>3+</th></tr>","<tr><th>4+</th></tr>","<tr><th>5+</th></tr>","<tr><th>0-4</th></tr>","<tr><th>Dom. pobednik</th></tr>","<tr><th>Gost pobednik</th></tr>","<tr><th>GG</th></tr>","<tr><th>I Pol. 2+</th></tr>","<tr><th>II Pol. 2+</th></tr>","<tr><th>1X</th></tr>","<tr><th>12</th></tr>","<tr><th>X2</th></tr>","<tr><th>I0-1&II0-1</th></tr>","<tr><th>I0-1&II0-2</th></tr>","<tr><th>I0-1&II0-3</th></tr>","<tr><th>I0-2&II0-1</th></tr>","<tr><th>I0-2&II0-2</th></tr>","<tr><th>I0-2&II0-3</th></tr>","<tr><th>I1+&II1+</th></tr>","</table>",'<div class="values-wrapper">','<div class="values"></div>',"</div>",$('<table class="sticky"><tr><th>Liga</th></tr><tr><th>Broj utakmica</th></tr><tr><th>Broj golova</th></tr><tr><th>0-0</th></tr><tr><th>X</th></tr><tr><th>1+</th></tr><tr><th>2+</th></tr><tr><th>3+</th></tr><tr><th>4+</th></tr><tr><th>5+</th></tr><tr><th>0-4</th></tr><tr><th>Dom. pobednik</th></tr><tr><th>Gost pobednik</th></tr><tr><th>GG</th></tr><tr><th>I Pol. 2+</th></tr><tr><th>II Pol. 2+</th></tr><tr><th>1X</th></tr><tr><th>12</th></tr><tr><th>X2</th></tr><tr><th>I0-1&II0-1</th></tr><tr><th>I0-1&II0-2</th></tr><tr><th>I0-1&II0-3</th></tr><tr><th>I0-2&II0-1</th></tr><tr><th>I0-2&II0-2</th></tr><tr><th>I0-2&II0-3</th></tr><tr><th>I1+&II1+</th></tr></table><div class="values-wrapper"><div class="values"></div></div>').appendTo("#statistics");for(let t=0;t<leagusIds.length;t++)a[leagusIds[t]]&&$(a[leagusIds[t]]).appendTo("#statistics .values");setTimeout(function(){var t=$("#statisticsTeam select"),a="";if(Object.keys(statistics).length>0)for(var e in statistics)if(statistics.hasOwnProperty(e)){allTeams[e]={},a+='<optgroup label="'+leagusName[e]+'">';var r=statistics[e];for(let t=0;t<r.length;t++){var s=r[t],h=s.teams.home,i=s.teams.away,o=h.id,n=i.id;allTeams[e][o]||(allTeams[e][o]=h.name,a+='<option data-leagueID="'+e+'" data-id="'+o+'">'+h.name+"</option>"),allTeams[e][n]||(allTeams[e][n]=i.name,a+='<option data-leagueID="'+e+'" data-id="'+n+'">'+i.name+"</option>")}a+="</optgroup>"}t.html(a),UpdateValuesWidth(),$(".chosen-select").multipleSelect({hideOptgroupCheckboxes:!0,selectAll:!1,width:"100%",onClick:function(t){if(t.selected){var a=t.data.leagueid,e=t.data.id,r=t.text,s=statistics[a].filter(t=>t.teams.away.id==e||t.teams.home.id==e),h=s.length,i=0,o=0,n=0,l=0,d=0,p=0,c=0,u=0,m=0,g=0,f=0,x=0,I=0,v=0,b=0,F=0,y=0,T=0,w=0,P=0,k=0,G=0,J=0,W=0,S=0,N=0,j=0,B=0,D=0,L=0,O=0,U=0;if($("#tim-"+r.replace(" ","_")).length)return!1;for(let t=0;t<s.length;t++){var X=s[t],A=X.score,_=A.halftime.home,E=A.halftime.away,V=A.fulltime.home,C=A.fulltime.away,M=V+C,H=_+E,R=M-H,Y=X.teams.home.id==e;Y?(i+=V,l++,V>0&&p++,V>1&&c++,V>2&&u++):(i+=C,d++,C>0&&m++,C>1&&g++,C>2&&f++),M>0?(x++,M>1&&I++,M>2&&v++,M>3&&b++,M>4&&F++):o++,M<5&&y++,V===C&&n++,Y&&V>C&&T++,!Y&&C>V&&w++,H>1&&k++,R>1&&G++,V>0&&C>0&&P++,Y?(V>C||V===C)&&J++:(C>V||V===C)&&S++,V!=C&&W++,H<=1&&R<=1&&N++,H<=1&&R<=2&&j++,H<=1&&R<=3&&B++,H<=2&&R<=1&&D++,H<=2&&R<=2&&L++,H<=2&&R<=3&&O++,H>=1&&R>=1&&U++}var z='<table data-id="'+e+'" data-teamName="'+r+'" id="tim-'+r.replace(" ","_")+'">';z+="<tr><th>"+r+"</th></tr>",z+="<tr><th>"+h+"</th></tr>",z+="<tr><th>"+i+" ( "+(i/h).toFixed(1)+" )</th></tr>",z+="<tr><th>"+o+" <span>("+(o/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+n+" <span>("+(n/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+x+" <span>("+(x/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+I+" <span>("+(I/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+v+" <span>("+(v/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+b+" <span>("+(b/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+F+" <span>("+(F/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+y+" <span>("+(y/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+p+" <span>("+(p/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+c+" <span>("+(c/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+u+" <span>("+(u/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+m+" <span>("+(m/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+g+" <span>("+(g/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+f+" <span>("+(f/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+T+" <span>("+(T/l*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+w+" <span>("+(w/d*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+P+" <span>("+(P/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+k+" <span>("+(k/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+G+" <span>("+(G/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+J+" <span>("+(J/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+W+" <span>("+(W/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+S+" <span>("+(S/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+N+" <span>("+(N/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+j+" <span>("+(j/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+B+" <span>("+(B/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+D+" <span>("+(D/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+L+" <span>("+(L/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+O+" <span>("+(O/h*100).toFixed(2)+"%)</span></th></tr>",z+="<tr><th>"+U+" <span>("+(U/h*100).toFixed(2)+"%)</span></th></tr>",z+='<tr class="remove_table"><th>X</th></tr>',z+="</table>",$(z).appendTo("#statisticsTeam .values")}else $("#tim-"+t.text.replace(" ","_")).length&&$("#tim-"+t.text.replace(" ","_")).remove();UpdateValuesWidth()}})},100)}})}}function UpdateValuesWrapperWidth(){$(".values-wrapper").each(function(){var t=$(this).parent();$(this).width(t.width()-t.find(".sticky").width()-5)})}function UpdateValuesWidth(){UpdateValuesWrapperWidth(),$(".values-wrapper").each(function(){var t=$(this).find("table"),a=$(this).find(".values"),e=0;t.each(function(){e+=$(this).outerWidth(!0)}),e>$(this).width()?a.width(e):a.css("width","")})}stats+="<tr><th>Tim</th></tr>",stats+="<tr><th>Broj utakmica</th></tr>",stats+="<tr><th>Broj golova</th></tr>",stats+="<tr><th>0-0</th></tr>",stats+="<tr><th>X</th></tr>",stats+="<tr><th>1+</th></tr>",stats+="<tr><th>2+</th></tr>",stats+="<tr><th>3+</th></tr>",stats+="<tr><th>4+</th></tr>",stats+="<tr><th>5+</th></tr>",stats+="<tr><th>0-4</th></tr>",stats+="<tr><th>Tim domacin 1+</th></tr>",stats+="<tr><th>Tim domacin 2+</th></tr>",stats+="<tr><th>Tim domacin 3+</th></tr>",stats+="<tr><th>Tim gost 1+</th></tr>",stats+="<tr><th>Tim gost 2+</th></tr>",stats+="<tr><th>Tim gost 3+</th></tr>",stats+="<tr><th>Dom. pobednik</th></tr>",stats+="<tr><th>Gost pobednik</th></tr>",stats+="<tr><th>GG</th></tr>",stats+="<tr><th>I Pol. 2+</th></tr>",stats+="<tr><th>II Pol. 2+</th></tr>",stats+="<tr><th>1X</th></tr>",stats+="<tr><th>12</th></tr>",stats+="<tr><th>X2</th></tr>",stats+="<tr><th>I0-1&II0-1</th></tr>",stats+="<tr><th>I0-1&II0-2</th></tr>",stats+="<tr><th>I0-1&II0-3</th></tr>",stats+="<tr><th>I0-2&II0-1</th></tr>",stats+="<tr><th>I0-2&II0-2</th></tr>",stats+="<tr><th>I0-2&II0-3</th></tr>",stats+="<tr><th>I1+&II1+</th></tr>",stats+='<tr class="remove_table" style="display: none;"><th>X</th></tr>',stats+="</table>",stats+='<div class="values-wrapper">',stats+='<div class="values"></div>',stats+="</div>",$(stats).appendTo("#statisticsTeam"),UpdateValuesWrapperWidth(),$("body").on("click","#pantryLoad",function(){GetPantryJson()}).on("click","#apiLoad",function(){var t=new Date,a=String(t.getDate()).padStart(2,"0");globalJson={fixtures:[],predictions:[],time:a},GetFixtures()}).on("click","#getStatistics",function(){getStatistics()}).on("click",".remove_table",function(t){$(this).closest("table").remove(),UpdateValuesWidth();var a=$(this).closest("[data-teamName]").attr("data-teamName");$(".chosen-select").multipleSelect("uncheck",a)}).on("click","a[team-id]",function(t){t.preventDefault}),window.UpdatePantryJson=function(t){if(t){var a={url:"https://getpantry.cloud/apiv1/pantry/1f3a2c9e-cbc5-4c5b-b93f-5d0f48a83ce8/basket/bet",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify(t)};$.ajax(a).done(function(t){GetPantryJson()}).fail(function(){setTimeout(function(){UpdatePantryJson(globalJson)},3e3)})}},$(window).on("resize",function(){UpdateValuesWidth()});var numberOfFixturesLoaded=0;function WriteToBody(t){numberOfFixturesLoaded++;var a=(t=JSON.parse(t)).response;for(let t=0;t<a.length;t++){var e=a[t];e.fixture.id;globalJson.fixtures.push(e)}if(numberOfFixturesLoaded==leagusIds.length){var r=globalJson.fixtures.length;console.log("ALl fixtures loaded");for(let t=0;t<r;t++)setTimeout(function(){GetPrediction(globalJson.fixtures[t].fixture.id,t===r-1)},2e3*t)}}function GetPrediction(t,a){fetch("https://v3.football.api-sports.io/predictions?fixture="+t,{method:"GET",headers:{"x-rapidapi-host":"v3.football.api-sports.io","x-rapidapi-key":API}}).then(t=>t.text()).then(e=>WritePrediction(e,t,a)).catch(t=>console.log("error",t))}function WritePrediction(t,a,e){if((t=JSON.parse(t)).response.length){var r=t.response[0].predictions;r.id=a,console.log("prediction "+a+" loaded"),globalJson.predictions.push(r),WriteToBodyPantry(globalJson)}e&&(console.log("UPDATE PANTRY JSON HERE"),UpdatePantryJson(globalJson))}function WriteToBodyPantry(t){var a=t.fixtures,e=document.getElementById("wrapper"),r="";for(let e=0;e<leagusIds.length;e++){var s=leagusIds[e],h=a.filter(t=>t.league.id==s);if(0!==h.length){r+='<div class="league" league-id="'+s+'" league-name="'+leagusName[s]+'">',r+='<div class="league-logo"><img src="'+h[0].league.logo+'"/></div>';for(let a=0;a<h.length;a++){var i=h[a],o=i.fixture.id,n=i.teams.home,l=i.teams.away,d=new Date(i.fixture.date),p=t.predictions.find(t=>t.id===o);p&&(r+='<div class="row" data-round="'+i.league.round+'">',r+='<div class="time">'+d.getDate()+"."+(d.getMonth()+1)+"."+d.getFullYear()+" - "+d.getHours()+":"+(d.getMinutes()<10?"0":"")+d.getMinutes()+"h</div>",r+='<div class="team home">',r+='<img src="'+n.logo+'"/><a team-id="'+n.id+'">'+n.name+"</a>",r+="</div>",r+='<div id="'+o+'" class="prediction">',p.under_over?r+=p.under_over:p.advice?r+=p.advice.replace("Double chance","Dupla šansa").replace(" or "," ili ").replace("Winner","Pobednik").replace("draw","nerešeno").replace("and","i").replace("goals","golova").replace("Combo",""):r+="------",r+="</div>",r+='<div class="team away">',r+='<img src="'+l.logo+'"/><a team-id="'+l.id+'" >'+l.name+"</a>",r+="</div>",r+="</div>")}r+="</div>"}}e.innerHTML=r}